[startup]
init-timeout = 30


[brain]
sleep-time = 23:00
wakeup-time = 07:00
require-synced-time = yes


[trigger:control-rotary]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/event/frontend/device/event"
mqtt-payload-jsonpath = '$[?(device.type=="rotary" & device.name=="control")].event.delta'
signal-json-formatter = '{"enclosure": {"control": {"delta": "%(jsonpath)s"}}}'

[trigger:control-button]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/event/frontend/device/event"
mqtt-payload-jsonpath = '$[?(device.type=="button" & device.name=="control")].event.status'
signal-json-formatter = '{"enclosure": {"control": {"select": "%(jsonpath)s"}}}'

[trigger:volume-rotary]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/event/frontend/device/event"
mqtt-payload-jsonpath = '$[?(device.type=="rotary" & device.name=="volume")].event.delta'
signal-json-formatter = '{"enclosure": {"volume": {"delta": "%(jsonpath)s"}}}'

[trigger:volume-button]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/event/frontend/device/event"
mqtt-payload-jsonpath = '$[?(device.type=="button" & device.name=="volume")].event.status'
signal-json-formatter = '{"enclosure": {"volume": {"mute": "%(jsonpath)s"}}}'

[trigger:frontend-runlevel]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/event/frontend/runlevel"
mqtt-payload-regex = "(?P<runlevel>\w+)"
signal-json-formatter = '{"frontend": {"runlevel": "%(runlevel)s"}}'

[trigger:frontend-gui-screen]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/event/frontend/gui/event"
mqtt-payload-jsonpath = '$[?(screen)].screen'
signal-json-formatter = '{"frontend": {"gui": {"screen": {"name": "%(jsonpath)s", "parameter": {}, "origin": "arduino"}}}}'

[trigger:frontend-gui-overlay]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/event/frontend/gui/event"
mqtt-payload-jsonpath = '$[?(overlay)].overlay'
signal-json-formatter = '{"frontend": {"gui": {"overlay": {"name": "%(jsonpath)s", "parameter": {}, "origin": "arduino"}}}}'

[trigger:frontend-error]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/event/frontend/application/error"
mqtt-payload-regex = "(?P<error>.+)"
signal-json-formatter = '{"frontend": %(error)s}'

[trigger:kalliope-runlevel]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/event/kalliope/runlevel"
mqtt-payload-regex = "(?P<runlevel>\w+)"
signal-json-formatter = '{"kalliope": {"runlevel": "%(runlevel)s"}}'

[trigger:brain-script]
plugin = hal9000.brain.plugins.mqtt
mqtt-topic = "hal9000/command/brain/script"
mqtt-payload-jsonpath = '$[?(name)].name'
signal-json-formatter = '{"brain": {"script": "%(jsonpath)s"}}'


[action:enclosure]
plugin = hal9000.brain.plugins.enclosure

[action:frontend]
plugin = hal9000.brain.plugins.frontend

[action:kalliope]
plugin = hal9000.brain.plugins.kalliope
kalliope-trigger-mqtt-topic = kalliope/trigger/multiplexer/event

[action:mqtt]
plugin = hal9000.brain.plugins.mqtt


[enclosure:components]
control = hal9000.brain.plugins.enclosure.control.Control
volume = hal9000.brain.plugins.enclosure.volume.Volume

[enclosure:control]
item-files = brain.d/control/menu/main.ini
menu-files = brain.d/control/menu/en/main.ini

[enclosure:volume]
initial-volume = 50
initial-mute = False
volume-step = 5


[script:reboot]
exec = ./scripts/reboot.py

[script:poweroff]
exec = ./scripts/poweroff.py


[help]
error-url = "https://github.com/juergenpabel/HAL9000-demo-en_US/wiki/ERROR_{id}"
splash-url = "https://github.com/juergenpabel/HAL9000-demo-en_US/wiki/SPLASH_{id}"


[mqtt]
server = 127.0.0.1
port = 1883


[loggers]
keys = root

[handlers]
keys=stdout

[formatters]
keys=stdout

[logger_root]
level=INFO
handlers=stdout

[handler_stdout]
class=StreamHandler
formatter=stdout
args=(sys.stdout,)

[formatter_stdout]
format=%(asctime)s - %(levelname)-8s - %(message)s
datefmt=

